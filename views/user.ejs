<!DOCTYPE html>
<html lang="en">

<%- include('layouts/head'); -%>

<body>
  <%- include('layouts/navbar'); -%>
  
  <div class="container">
      <div class="user-info">
        <div class="main-info">
            <img class="user-avatar" src="<%= avatar_path %>" alt="<%= user %>">

            <% if(nickname == user) { %>
                <form action="/user/avatar" method="post" encType="multipart/form-data">
                    <label id="avatar-lable" for="avatar">Изменить аватар:</label>
                    <input type="file" accept=".jpg, .jpeg, .png" name="avatar" id="avatar-upload">
                    <button type="submit">Изменить</button>
                </form>
            <% } %>
        </div>
        <div class="other-info">
            <h1 class="user-nickname"><%= user %></h1>
            <p class="reg-time">Дата регистрации: <%= regTime %></p>
            <p class="post-count">Количество сделанных постов: <%= postCount %></p>
            <p class="liked-count">Количество понравившихся постов: <%= likedCount %></p>
            <p class="comment-count">Количество оставленных комментариев: <%= likedCount %></p>
        </div>
      </div>
        
        <div class="user-posts">
            <% if(posts.length > 0) { %>
                <% if(nickname == user) { %>
                    <p>Ваши посты:</p>
                <% } else { %>
                    <p>Посты пользователя <%= user %>:</p>
                <% } %>

                <div class="posts">
                    <% for(let i = 0; i < posts.length; i++) { %>
                        <div class="post">
                            <a href="/post/<%= posts[i].post_id %>"><%= posts[i].title %> <%= posts[i].last_update %></a>
                        </div>
                    <% } %>
                </div>
            <% } else { %>
                <% if(nickname == user) { %>
                    <p>Вы еще не сделали никакой записи</p>
                <% } else { %>
                    <p>Пользователь <%= user %> еще не сделал никакой записи</p>
                <% } %>
            <% } %>

            <!-- если это профиль текущего пользователя -->
            <div class="liked-posts">
            <% if(liked.length > 0) { %>
                <% if(nickname == user) { %>
                    <p>Посты, которые вам понравились:</p>
                <% } else { %>
                    <p>Посты, которые понравились <span><%= user %></span>:</p>
                <% } %>
                    <% for(let i = 0; i < liked.length; i++) { %>
                        <div class="post">
                            <a href="/post/<%= liked[i].post_id %>"><%= liked[i].title %> <%= liked[i].last_update %></a>
                        </div>
                    <% } %>
            <% } else { %>
                <% if(nickname == user) { %>
                    <p>Вы еще не оценили никаких постов</p>
                <% } else { %>
                    <p>Пользователь <span><%= user %></span> еще не оценил никаких постов</p>
                <% } %>
            <% } %>
            </div>
        </div>
  </div>
</body>
</html>